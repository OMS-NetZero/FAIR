%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\let\originalPassOptionsToPackage\PassOptionsToPackage
\makeatletter
\def\PassOptionsToPackage#1{%
  \def\@tempa{#1}\def\@tempb{pdfencoding=unicode}%
  \ifx\@tempa\@tempb\expandafter\@gobbletwo
  \else\expandafter\originalPassOptionsToPackage\fi {#1}}
\makeatother

\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional\else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
\fi\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}

\usepackage{geometry}
\usepackage{multirow}
\usepackage{eqparbox}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}


% Jupyter Notebook prompt colors
\definecolor{nbsphinxin}{HTML}{303F9F}
\definecolor{nbsphinxout}{HTML}{D84315}
% ANSI colors for output streams and traceback highlighting
\definecolor{ansi-black}{HTML}{3E424D}
\definecolor{ansi-black-intense}{HTML}{282C36}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-red-intense}{HTML}{B22B31}
\definecolor{ansi-green}{HTML}{00A250}
\definecolor{ansi-green-intense}{HTML}{007427}
\definecolor{ansi-yellow}{HTML}{DDB62B}
\definecolor{ansi-yellow-intense}{HTML}{B27D12}
\definecolor{ansi-blue}{HTML}{208FFB}
\definecolor{ansi-blue-intense}{HTML}{0065CA}
\definecolor{ansi-magenta}{HTML}{D160C4}
\definecolor{ansi-magenta-intense}{HTML}{A03196}
\definecolor{ansi-cyan}{HTML}{60C6C8}
\definecolor{ansi-cyan-intense}{HTML}{258F8F}
\definecolor{ansi-white}{HTML}{C5C1B4}
\definecolor{ansi-white-intense}{HTML}{A1A6B2}
\definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
\definecolor{ansi-default-inverse-bg}{HTML}{000000}

% Define "notice" environment, which was removed in Sphinx 1.7.
% At some point, "notice" should be replaced by "sphinxadmonition",
% which is available since Sphinx 1.5.
\makeatletter
\@ifundefined{notice}{%
\newenvironment{notice}{\begin{sphinxadmonition}}{\end{sphinxadmonition}}%
}{}
\makeatother



\title{FAIR Documentation}
\date{May 15, 2018}
\release{1.3}
\author{FAIR development team}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}



\chapter{Introduction}
\label{\detokenize{intro:introduction}}\label{\detokenize{intro:fair-finite-amplitude-impulse-response-simple-climate-model}}\label{\detokenize{intro::doc}}
The Finite Amplitude Impulse Response (FAIR) model is a simple
emissions-based climate model. It allows the user to input emissions of
greenhouse gases and short lived climate forcers in order to estimate
global mean atmospheric GHG concentrations, radiative forcing and
temperature anomalies.

The original FAIR model (v1.0) was developed to simulate the earth
system response to CO$_{\text{2}}$ emissions, with all non-CO$_{\text{2}}$ forcing implemented as an \sphinxquotedblleft{}external\sphinxquotedblright{} source. It was developed by Richard
Millar, Zebedee Nicholls, Pierre Friedlingstein and Myles Allen. The
motivation for developing it and its formulation is documented in a
\sphinxhref{https://www.atmos-chem-phys.net/17/7213/2017/acp-17-7213-2017.html}{paper published in Atmospheric Chemistry and Physics in 2017}.

The emissions-based model (v1.3) extends FAIR by replacing all sources of
non-CO$_{\text{2}}$ forcing with relationships that are based on the
source emissions, with the exception of natural forcings (variations
in solar irradiance and volcanic eruptions). It is useful for
assessing future policy commitments to anthropogenic emissions
(something which we can control) than to radiative forcing (something
which is less certain and which we can only partially control).

If you use this model, please cite the following references:
\begin{enumerate}
\item {} 
Smith, C. J., Forster, P. M., Allen, M., Leach, N., Millar, R. J., Passerello, G. A., and Regayre, L. A.: FAIR v1.3: A simple emissions-based impulse response and carbon cycle model, Geosci. Model Dev. \sphinxurl{https://doi.org/10.5194/gmd-2017-266}, 2018.

\item {} 
Millar, R. J., Nicholls, Z. R., Friedlingstein, P., and Allen, M. R.: A modified impulse-response representation of the global near-surface air temperature and atmospheric concentration response to carbon dioxide emissions, Atmos. Chem. Phys., 17, 7213-7228, \sphinxurl{https://doi.org/10.5194/acp-17-7213-2017}, 2017.

\end{enumerate}

For assistance, \sphinxhref{https://github.com/OMS-NetZero/FAIR/issues}{set up an issue on the GitHub site} or contact Chris Smith (c.j.smith1 \textless{}AT\textgreater{} leeds \textless{}DOT\textgreater{} ac \textless{}DOT\textgreater{} uk).


\chapter{Installation}
\label{\detokenize{installation:installation}}\label{\detokenize{installation::doc}}

\section{From the Python Package Index (PyPI)}
\label{\detokenize{installation:from-the-python-package-index-pypi}}
Probably the easiest way: simply type \sphinxcode{pip install fair} from a terminal.


\section{From GitHub}
\label{\detokenize{installation:from-github}}
The latest release (as a tar.gz or zip file) can be obtained from \sphinxurl{https://github.com/OMS-NetZero/FAIR/releases}, or the most current unreleased version can be cloned from \sphinxurl{https://github.com/OMS-NetZero/FAIR}.


\chapter{Examples}
\label{\detokenize{examples::doc}}\label{\detokenize{examples:examples}}
Here are some simple examples of how to run and use the Finite Amplitude
Impulse Response (FAIR) model run in the jupyter notebook.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} inline
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{fair}
\PYG{n}{fair}\PYG{o}{.}\PYG{n}{\PYGZus{}\PYGZus{}version\PYGZus{}\PYGZus{}}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k+kn}{as} \PYG{n+nn}{np}

\PYG{k+kn}{from} \PYG{n+nn}{matplotlib} \PYG{k+kn}{import} \PYG{n}{pyplot} \PYG{k}{as} \PYG{n}{plt}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{style}\PYG{o}{.}\PYG{n}{use}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{seaborn\PYGZhy{}darkgrid}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rcParams}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{figure.figsize}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{16}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{)}
\end{sphinxVerbatim}

The \sphinxquotedblleft{}engine\sphinxquotedblright{} of FAIR is the \sphinxcode{fair\_scm} function in the \sphinxcode{forward}
module.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{fair.forward} \PYG{k+kn}{import} \PYG{n}{fair\PYGZus{}scm}
\end{sphinxVerbatim}


\section{CO2 driven run}
\label{\detokenize{examples:co2-driven-run}}

\subsection{Basic example}
\label{\detokenize{examples:basic-example}}
Here we show how FAIR can be run with step change CO2 emissions and
sinusoidal non-CO2 forcing timeseries. This is a FAIR v1.0-style setup
in which CO2 is the only emitted species.

In almost every application of FAIR you will probably want to vary the
\sphinxcode{emissions} time series going in to \sphinxcode{fair\_scm}. In CO2-only mode
this is a 1D array of CO2 emissions. Setting \sphinxcode{useMultigas=False} turns
off the emissions from non-CO2 species.

The output from FAIR is a 3-tuple of \sphinxcode{(C,F,T)} arrays. In CO2 mode,
both \sphinxcode{C} (representing CO2 concentrations in ppm) and \sphinxcode{F} (total
radiative forcing in W m-2) are 1D arrays. \sphinxcode{T} (temperature change
since the pre-industrial) is always output as a 1D array.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set up emissions and forcing arrays}
\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} Unit: GtC}
\PYG{n}{emissions}\PYG{p}{[}\PYG{l+m+mi}{125}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{10.0}
\PYG{n}{other\PYGZus{}rf} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{other\PYGZus{}rf}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{14.0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} run the model}
\PYG{n}{C}\PYG{p}{,}\PYG{n}{F}\PYG{p}{,}\PYG{n}{T} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot the output}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{emissions}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions (GtC)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{C}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO\PYGZdl{}\PYGZus{}2\PYGZdl{} concentrations (ppm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{orange}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_6_0}.png}


\subsection{Forcing-only runs}
\label{\detokenize{examples:forcing-only-runs}}
If you want to specify a pure forcing and bypass the carbon cycle
routine this is also possible by setting \sphinxcode{emissions=False}. This time,
we will add a linear forcing to the sinusodal forcing above. Note that
the CO2 concentrations are not updated from their pre-industrial value.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Define a forcing time series}
\PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{other\PYGZus{}rf}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.02}\PYG{o}{*}\PYG{n}{x} \PYG{o}{+} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{14.0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} run the model with emissions off}
\PYG{n}{\PYGZus{}}\PYG{p}{,}\PYG{n}{F}\PYG{p}{,}\PYG{n}{T} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot the output}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{other\PYGZus{}rf}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{orange}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{other\PYGZus{}rf}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_8_0}.png}


\subsection{Varying the carbon cycle parameters}
\label{\detokenize{examples:varying-the-carbon-cycle-parameters}}
FAIR is set up to simulate the responses to more complex earth system
models. This is achieved by a scaling of a four-box decay model for
atmospheric carbon dioxide emissions based on the airborne fraction of
carbon dioxide. This in turn depends on the efficiency of carbon sinks,
which is a function of temperature change and total accumulated carbon
uptake. Much of the technical detail is described in \sphinxhref{https://www.atmos-chem-phys.net/17/7213/2017/acp-17-7213-2017.html}{Millar et al.,
(2017)}.

In the carbon cycle, the important variables are \sphinxcode{r0}, \sphinxcode{rc} and
\sphinxcode{rt} which are in turn the pre-industrial sensitivity of carbon sinks,
the sensitivity to cumulative carbon dioxide emissions, and sensitivity
to temperature change.

This time we will demonstrate with a 10 Gt constant pulse and use a
10-member ensemble.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set up emissions and forcing arrays}
\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mf}{10.0}   \PYG{c+c1}{\PYGZsh{} Unit: GtC}
\PYG{n}{emissions}\PYG{p}{[}\PYG{l+m+mi}{125}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\PYG{n}{other\PYGZus{}rf} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{other\PYGZus{}rf}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{14.0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} create output arrays}
\PYG{n}{nrun} \PYG{o}{=} \PYG{l+m+mi}{10}
\PYG{n}{C} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{F} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Generate some random values of carbon cycle parameters}
\PYG{c+c1}{\PYGZsh{} use a seed for reproducible results}
\PYG{k+kn}{from} \PYG{n+nn}{scipy.stats} \PYG{k+kn}{import} \PYG{n}{norm}
\PYG{n}{r0} \PYG{o}{=} \PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{n}{nrun}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{35}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{5.0}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{)}
\PYG{n}{rc} \PYG{o}{=} \PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{n}{nrun}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mf}{0.019}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{0.003}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{77}\PYG{p}{)}
\PYG{n}{rt} \PYG{o}{=} \PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{n}{nrun}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mf}{4.165}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{1729}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} initialise plot}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{emissions}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions (GtC)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} run the model and plot outputs}
\PYG{k}{print} \PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{run      r0     rc    rt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{nrun}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{print} \PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZpc{}5.3f}\PYG{l+s+s2}{ }\PYG{l+s+si}{\PYGZpc{}5.4f}\PYG{l+s+s2}{ }\PYG{l+s+si}{\PYGZpc{}5.3f}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{r0}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{rc}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{rt}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
        \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
        \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
        \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
        \PYG{n}{r0} \PYG{o}{=} \PYG{n}{r0}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}
        \PYG{n}{rc} \PYG{o}{=} \PYG{n}{rc}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}
        \PYG{n}{rt} \PYG{o}{=} \PYG{n}{rt}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
    \PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{run }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{i}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO\PYGZdl{}\PYGZus{}2\PYGZdl{} concentrations (ppm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{run}      \PYG{n}{r0}     \PYG{n}{rc}    \PYG{n}{rt}
  \PYG{l+m+mi}{0}  \PYG{l+m+mf}{37.484} \PYG{l+m+mf}{0.0197} \PYG{l+m+mf}{3.821}
  \PYG{l+m+mi}{1}  \PYG{l+m+mf}{34.309} \PYG{l+m+mf}{0.0210} \PYG{l+m+mf}{3.755}
  \PYG{l+m+mi}{2}  \PYG{l+m+mf}{38.238} \PYG{l+m+mf}{0.0173} \PYG{l+m+mf}{4.991}
  \PYG{l+m+mi}{3}  \PYG{l+m+mf}{42.615} \PYG{l+m+mf}{0.0202} \PYG{l+m+mf}{3.877}
  \PYG{l+m+mi}{4}  \PYG{l+m+mf}{33.829} \PYG{l+m+mf}{0.0204} \PYG{l+m+mf}{4.714}
  \PYG{l+m+mi}{5}  \PYG{l+m+mf}{33.829} \PYG{l+m+mf}{0.0131} \PYG{l+m+mf}{4.628}
  \PYG{l+m+mi}{6}  \PYG{l+m+mf}{42.896} \PYG{l+m+mf}{0.0198} \PYG{l+m+mf}{3.668}
  \PYG{l+m+mi}{7}  \PYG{l+m+mf}{38.837} \PYG{l+m+mf}{0.0143} \PYG{l+m+mf}{3.736}
  \PYG{l+m+mi}{8}  \PYG{l+m+mf}{32.653} \PYG{l+m+mf}{0.0237} \PYG{l+m+mf}{4.202}
  \PYG{l+m+mi}{9}  \PYG{l+m+mf}{37.713} \PYG{l+m+mf}{0.0168} \PYG{l+m+mf}{4.430}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_10_1}.png}


\subsection{Changing CO2 lifetime and partitioning coefficients}
\label{\detokenize{examples:changing-co2-lifetime-and-partitioning-coefficients}}
The CO2 initial lifetime and partitioning coefficients are quantified by
the \sphinxcode{tau} and \sphinxcode{a} parameters respectively. The rationale follows the
four-box model in \sphinxhref{https://www.ipcc.ch/pdf/assessment-report/ar5/wg1/supplementary/WG1AR5\_Ch08SM\_FINAL.pdf}{Myhre et al.
(2013)},
scaled by the impact of land and ocean carbon uptake as described in
\sphinxhref{https://www.atmos-chem-phys.net/17/7213/2017/acp-17-7213-2017.html}{Millar et al.,
(2017)}.

\sphinxcode{tau}, in years, is the time constant for each carbon pool and is
ordered from slowest carbon pool to fastest, and \sphinxcode{a} is the fraction
of new CO2 emissions going in to each pool. The first element of \sphinxcode{tau}
is usually very large and represents the fraction of CO2 emissions that
remain in the atmosphere \sphinxquotedblleft{}quasi-permanently\sphinxquotedblright{}, i.e. removed only on
geological time scales, far past the range of times in which FAIR is
expected to give useful results (although nobody will stop you using a
smaller value as we demonstrate). An error should be thrown if the sum
of \sphinxcode{a} is not one.

In the second figure it can be seen that these parameter settings are
important for the rate of decay of atmospheric CO2 in particular.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set up emissions and forcing arrays}
\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mf}{10.0}   \PYG{c+c1}{\PYGZsh{} Unit: GtC}
\PYG{n}{emissions}\PYG{p}{[}\PYG{l+m+mi}{125}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\PYG{n}{other\PYGZus{}rf} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{other\PYGZus{}rf}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{14.0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} create output arrays}
\PYG{n}{nrun}\PYG{o}{=}\PYG{l+m+mi}{4}
\PYG{n}{C} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{F} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Play with the carbon boxes}
\PYG{n}{tau2} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{400.0}\PYG{p}{,} \PYG{l+m+mf}{100.0}\PYG{p}{,} \PYG{l+m+mf}{5.0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{a2}   \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mf}{0.25}

\PYG{c+c1}{\PYGZsh{} Nobody said we had to stick to a four\PYGZhy{}box model...}
\PYG{n}{tau3} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{1000.0}\PYG{p}{,} \PYG{l+m+mf}{150.0}\PYG{p}{,} \PYG{l+m+mf}{70.0}\PYG{p}{,} \PYG{l+m+mf}{15.0}\PYG{p}{,} \PYG{l+m+mf}{3.0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{a3}   \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} A pathological case where tau0 is much smaller than 1e6}
\PYG{c+c1}{\PYGZsh{} in this example CO2 behaves more like other GHGs}
\PYG{n}{tau4} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{10.}\PYG{p}{,} \PYG{l+m+mf}{4.}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{0.3}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{a4}   \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mf}{0.25}

\PYG{c+c1}{\PYGZsh{} run the model for default values}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} ... and for our alternatives}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{tau}\PYG{o}{=}\PYG{n}{tau2}\PYG{p}{,}
    \PYG{n}{a}\PYG{o}{=}\PYG{n}{a2}\PYG{p}{)}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{tau}\PYG{o}{=}\PYG{n}{tau3}\PYG{p}{,}
    \PYG{n}{a}\PYG{o}{=}\PYG{n}{a3}\PYG{p}{)}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{tau}\PYG{o}{=}\PYG{n}{tau4}\PYG{p}{,}
    \PYG{n}{a}\PYG{o}{=}\PYG{n}{a4}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot the output}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{emissions}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions (GtC)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{handles} \PYG{o}{=} \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{C}\PYG{p}{)}
\PYG{n}{labels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4\PYGZhy{}box default}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4\PYGZhy{}box alternative}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{6\PYGZhy{}box}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pathological}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{handles}\PYG{p}{,} \PYG{n}{labels}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO\PYGZdl{}\PYGZus{}2\PYGZdl{} concentrations (ppm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_12_0}.png}


\subsection{ECS and TCR}
\label{\detokenize{examples:ecs-and-tcr}}
The equilibrium climate sensitivity (defined as the equilibrium warming
for an abrupt doubling of CO2 concentrations) and transient climate
response (defined as the temperature change after a CO2 doubling to a 1\%
per year compound increase in CO2 concentrations - approximately 70
years) are both key uncertainties in climate science. The temperature
response in FAIR depends on both. The \sphinxcode{tcrecs} parameter, a 2-element
array, controls this.

This next example shows the effect of varying the ECS and TCR. (Note
that by definition the case ECS=1.0, TCR=1.75 is not possible, but FAIR
can handle such cases anyway).

The biggest effect is on the temperature response, but as the
temperature feeds back into the carbon cycle, this also affects the CO2
concentrations and the radiative forcing.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set up emissions and forcing arrays}
\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{125}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{10.0}

\PYG{c+c1}{\PYGZsh{} create output arrays}
\PYG{n}{nrun}\PYG{o}{=}\PYG{l+m+mi}{9}
\PYG{n}{C} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{F} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} initialise plot}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{emissions}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions (GtC)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}

\PYG{n}{ecs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.0}\PYG{p}{,} \PYG{l+m+mf}{2.0}\PYG{p}{,} \PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{l+m+mf}{4.0}\PYG{p}{,} \PYG{l+m+mf}{5.0}\PYG{p}{,} \PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{l+m+mf}{3.0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{tcr} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.75}\PYG{p}{,} \PYG{l+m+mf}{1.75}\PYG{p}{,} \PYG{l+m+mf}{1.75}\PYG{p}{,} \PYG{l+m+mf}{1.75}\PYG{p}{,} \PYG{l+m+mf}{1.75}\PYG{p}{,} \PYG{l+m+mf}{0.75}\PYG{p}{,} \PYG{l+m+mf}{1.25}\PYG{p}{,} \PYG{l+m+mf}{2.25}\PYG{p}{,} \PYG{l+m+mf}{2.75}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{colors} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}800000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}808000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}008000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}008080}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}000080}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}000000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}004000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}00c000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}00ff00}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} run the model and plot outputs}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{nrun}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
        \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
        \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
        \PYG{n}{tcrecs}\PYG{o}{=}\PYG{p}{[}\PYG{n}{tcr}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{ecs}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}
    \PYG{p}{)}

    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{colors}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ECS=}\PYG{l+s+si}{\PYGZpc{}3.1f}\PYG{l+s+s1}{K, TCR=}\PYG{l+s+si}{\PYGZpc{}4.2f}\PYG{l+s+s1}{K}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{ecs}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{tcr}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO\PYGZdl{}\PYGZus{}2\PYGZdl{} concentrations (ppm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{colors}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{colors}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_14_0}.png}

Some recent studies (\sphinxhref{https://www.nature.com/articles/nclimate3278}{Armour
2017}; \sphinxhref{http://onlinelibrary.wiley.com/doi/10.1002/2016GL068406/abstract}{Gregory and
Andrews
2016})
suggest that ECS and TCR may not be constant. Fortunately we can
investigate this in FAIR by specifying \sphinxcode{tcrecs} as a two dimensional
\sphinxcode{(nt, 2)} array. Notice the effect that a varying ECS/TCR has on the
temperature.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{scipy.stats} \PYG{k+kn}{import} \PYG{n}{lognorm}\PYG{p}{,} \PYG{n}{truncnorm}

\PYG{c+c1}{\PYGZsh{} generate an ECS time series that roughly follows the AR5 likely range}
\PYG{n}{ecs} \PYG{o}{=} \PYG{n}{lognorm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{250}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{299}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} define TCR in terms of a realised warming fraction}
\PYG{n}{rwf} \PYG{o}{=} \PYG{n}{truncnorm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{250}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{301}\PYG{p}{)}
\PYG{n}{tcr} \PYG{o}{=} \PYG{n}{rwf}\PYG{o}{*}\PYG{n}{ecs}

\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{125}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{10.0}

\PYG{n}{C}\PYG{p}{,}\PYG{n}{F}\PYG{p}{,}\PYG{n}{T} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{tcrecs}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{[}\PYG{n}{tcr}\PYG{p}{,} \PYG{n}{ecs}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot the output}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{ecs}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ECS}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{tcr}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ls}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TCR}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ECS/TCR (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{C}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO\PYGZdl{}\PYGZus{}2\PYGZdl{} concentrations (ppm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{orange}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_16_0}.png}

The alternative is to specify the values of \sphinxcode{q} directly (a 2D array)
that go into the temperature calculation, bypassing \sphinxcode{tcrecs}
completely (setting \sphinxcode{tcrecs=None}). It is not known under what
circumstances the user may want to do this, but be assured it's
possible!

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set up emissions and forcing arrays}
\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mf}{10.0}
\PYG{n}{emissions}\PYG{p}{[}\PYG{l+m+mi}{125}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.0}

\PYG{n}{q} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{q}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.2}
\PYG{n}{q}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.6}
\PYG{n}{C}\PYG{p}{,}\PYG{n}{F}\PYG{p}{,}\PYG{n}{T} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{tcrecs}\PYG{o}{=}\PYG{n+nb+bp}{None}\PYG{p}{,}
    \PYG{n}{q}\PYG{o}{=}\PYG{n}{q}\PYG{p}{,}
\PYG{p}{)}
\PYG{k}{print} \PYG{p}{(}\PYG{n}{C}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{F}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{T}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{(}\PYG{l+m+mf}{500.5524349046043}\PYG{p}{,} \PYG{l+m+mf}{3.1476987553820677}\PYG{p}{,} \PYG{l+m+mf}{2.279051054881353}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Temperature time constants}
\label{\detokenize{examples:temperature-time-constants}}
The slow and fast response of global mean surface temperature is
governed by the two-element array \sphinxcode{d}: this parameter determines the
rate at which radiative forcing is \sphinxquotedblleft{}realised\sphinxquotedblright{} as a change in surface
temperature.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set up emissions and forcing arrays}
\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mf}{10.0}   \PYG{c+c1}{\PYGZsh{} Unit: GtC}
\PYG{n}{emissions}\PYG{p}{[}\PYG{l+m+mi}{125}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\PYG{n}{other\PYGZus{}rf} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{other\PYGZus{}rf}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{14.0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} create output arrays}
\PYG{n}{nrun}\PYG{o}{=}\PYG{l+m+mi}{4}
\PYG{n}{C} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{F} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{nrun}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} run the model for default values}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} ... and for our alternatives}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{d}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mf}{1000.0}\PYG{p}{,} \PYG{l+m+mf}{18.0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{d}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mf}{239.0}\PYG{p}{,} \PYG{l+m+mf}{1.0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{C}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}
    \PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
    \PYG{n}{other\PYGZus{}rf}\PYG{o}{=}\PYG{n}{other\PYGZus{}rf}\PYG{p}{,}
    \PYG{n}{useMultigas}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,}
    \PYG{n}{d}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mf}{60.}\PYG{p}{,} \PYG{l+m+mf}{4.1}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot the output}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{emissions}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions (GtC)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{handles} \PYG{o}{=} \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{C}\PYG{p}{)}
\PYG{n}{labels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{default}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{slow repsonse}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{quick mixed layer response}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{quick deep ocean response}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{handles}\PYG{p}{,} \PYG{n}{labels}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO\PYGZdl{}\PYGZus{}2\PYGZdl{} concentrations (ppm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{emissions}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_20_0}.png}


\section{Multi-species mode}
\label{\detokenize{examples:multi-species-mode}}
More interesting scenarios can be created with the full suite of forcing
agents. The key changes from CO2-only mode that should be remembered
are:
\begin{itemize}
\item {} 
This time the emissions dataset is a (nt, 40) array of inputs

\item {} 
\sphinxcode{useMultigas} should be set to \sphinxcode{True}, or omitted (this is the
default option)

\item {} 
The concentration and forcing outputs are themselves 2-dimensional
arrays of size (nt, 31) and (nt, 13) respectively

\item {} 
More input options to \sphinxcode{fair\_scm} become available.

\end{itemize}

The basic call to fair\_scm remains the same:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{(}\PYG{n}{C}\PYG{p}{,}\PYG{n}{F}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)} \PYG{o}{=} \PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Emissions}
\label{\detokenize{examples:emissions}}
In multi-species model, emissions are input as an \sphinxcode{(nt, 40)} emissions
array. The index order and units of the columns are as follows:

\begin{longtable}{|l|l|l|}
\hline
\sphinxstylethead{\relax 
Index
\unskip}\relax &\sphinxstylethead{\relax 
Species
\unskip}\relax &\sphinxstylethead{\relax 
Units
\unskip}\relax \\
\hline\endfirsthead

\multicolumn{3}{c}%
{\makebox[0pt]{\tablecontinued{\tablename\ \thetable{} -- continued from previous page}}}\\
\hline
\sphinxstylethead{\relax 
Index
\unskip}\relax &\sphinxstylethead{\relax 
Species
\unskip}\relax &\sphinxstylethead{\relax 
Units
\unskip}\relax \\
\hline\endhead

\hline \multicolumn{3}{|r|}{\makebox[0pt][r]{\tablecontinued{Continued on next page}}}\\\hline
\endfoot

\endlastfoot


0
&
Year
&
year
\\
\hline
1
&
CO2-fossil
&
GtC/yr
\\
\hline
2
&
CO2-landuse
&
GtC/yr
\\
\hline
3
&
CH4
&
Mt/yr
\\
\hline
4
&
N2O
&
MtN2/yr
\\
\hline
5
&
SOx
&
MtS/yr
\\
\hline
6
&
CO
&
Mt/yr
\\
\hline
7
&
NMVOC
&
Mt/yr
\\
\hline
8
&
NOx
&
MtN/yr
\\
\hline
9
&
BC
&
Mt/yr
\\
\hline
10
&
OC
&
Mt/yr
\\
\hline
11
&
NH3
&
Mt/yr
\\
\hline
12
&
CF4
&
kt/yr
\\
\hline
13
&
C2F6
&
kt/yr
\\
\hline
14
&
C6F14
&
kt/yr
\\
\hline
15
&
HFC23
&
kt/yr
\\
\hline
16
&
HFC32
&
kt/yr
\\
\hline
17
&
HFC43-10
&
kt/yr
\\
\hline
18
&
HFC125
&
kt/yr
\\
\hline
19
&
HFC134a
&
kt/yr
\\
\hline
20
&
HFC143a
&
kt/yr
\\
\hline
21
&
HFC227ea
&
kt/yr
\\
\hline
22
&
HFC245fa
&
kt/yr
\\
\hline
23
&
SF6
&
kt/yr
\\
\hline
24
&
CFC11
&
kt/yr
\\
\hline
25
&
CFC12
&
kt/yr
\\
\hline
26
&
CFC113
&
kt/yr
\\
\hline
27
&
CFC114
&
kt/yr
\\
\hline
28
&
CFC115
&
kt/yr
\\
\hline
29
&
CCl4
&
kt/yr
\\
\hline
30
&
Methyl chloroform
&
kt/yr
\\
\hline
31
&
HCFC22
&
kt/yr
\\
\hline
32
&
HCFC141b
&
kt/yr
\\
\hline
33
&
HCFC142b
&
kt/yr
\\
\hline
34
&
Halon 1211
&
kt/yr
\\
\hline
35
&
Halon 1202
&
kt/yr
\\
\hline
36
&
Halon 1301
&
kt/yr
\\
\hline
37
&
Halon 2401
&
kt/yr
\\
\hline
38
&
CH3Br
&
kt/yr
\\
\hline
39
&
CH3Cl
&
kt/yr
\\
\hline\end{longtable}


The index order of the columns follows that of the RCP datasets at
\sphinxurl{http://www.pik-potsdam.de/~mmalte/rcps/}.


\subsection{GHG Concentrations}
\label{\detokenize{examples:ghg-concentrations}}
Multi-species FAIR tracks the atmospheric concentrations of 31 GHG
species; \sphinxcode{C} is returned as a \sphinxcode{(nt, 31)} array. The colums are
indexed as follows:

\begin{longtable}{|l|l|l|}
\hline
\sphinxstylethead{\relax 
Index
\unskip}\relax &\sphinxstylethead{\relax 
Species
\unskip}\relax &\sphinxstylethead{\relax 
Units
\unskip}\relax \\
\hline\endfirsthead

\multicolumn{3}{c}%
{\makebox[0pt]{\tablecontinued{\tablename\ \thetable{} -- continued from previous page}}}\\
\hline
\sphinxstylethead{\relax 
Index
\unskip}\relax &\sphinxstylethead{\relax 
Species
\unskip}\relax &\sphinxstylethead{\relax 
Units
\unskip}\relax \\
\hline\endhead

\hline \multicolumn{3}{|r|}{\makebox[0pt][r]{\tablecontinued{Continued on next page}}}\\\hline
\endfoot

\endlastfoot


0
&
CO2
&
ppm
\\
\hline
1
&
CH4
&
ppb
\\
\hline
2
&
N2O
&
ppb
\\
\hline
3
&
CF4
&
ppt
\\
\hline
4
&
C2F6
&
ppt
\\
\hline
5
&
C6F14
&
ppt
\\
\hline
6
&
HFC23
&
ppt
\\
\hline
7
&
HFC32
&
ppt
\\
\hline
8
&
HFC43-10
&
ppt
\\
\hline
9
&
HFC125
&
ppt
\\
\hline
10
&
HFC134a
&
ppt
\\
\hline
11
&
HFC143a
&
ppt
\\
\hline
12
&
HFC227ea
&
ppt
\\
\hline
13
&
HFC245fa
&
ppt
\\
\hline
14
&
SF6
&
ppt
\\
\hline
15
&
CFC11
&
ppt
\\
\hline
16
&
CFC12
&
ppt
\\
\hline
17
&
CFC113
&
ppt
\\
\hline
18
&
CFC114
&
ppt
\\
\hline
19
&
CFC115
&
ppt
\\
\hline
20
&
CCl4
&
ppt
\\
\hline
21
&
Methyl chloroform
&
ppt
\\
\hline
22
&
HCFC22
&
ppt
\\
\hline
23
&
HCFC141b
&
ppt
\\
\hline
24
&
HCFC142b
&
ppt
\\
\hline
25
&
Halon 1211
&
ppt
\\
\hline
26
&
Halon 1202
&
ppt
\\
\hline
27
&
Halon 1301
&
ppt
\\
\hline
28
&
Halon 2401
&
ppt
\\
\hline
29
&
CH3Br
&
ppt
\\
\hline
30
&
CH3Cl
&
ppt
\\
\hline\end{longtable}



\subsection{Effective radiative forcing}
\label{\detokenize{examples:effective-radiative-forcing}}
Finally, a \sphinxcode{(nt, 13)} array \sphinxcode{F} of effective radiative forcing is
returned (all units W m-2):

\noindent\begin{tabulary}{\linewidth}{|L|L|}
\hline
\sphinxstylethead{\relax 
Index
\unskip}\relax &\sphinxstylethead{\relax 
Species
\unskip}\relax \\
\hline
0
&
CO2
\\
\hline
1
&
CH4
\\
\hline
2
&
N2O
\\
\hline
3
&
All other well-mixed GHGs
\\
\hline
4
&
Tropospheric O3
\\
\hline
5
&
Stratospheric O3
\\
\hline
6
&
Stratospheric water vapour from CH4 oxidation
\\
\hline
7
&
Contrails
\\
\hline
8
&
Aerosols
\\
\hline
9
&
Black carbon on snow
\\
\hline
10
&
Land use change
\\
\hline
11
&
Volcanic
\\
\hline
12
&
Solar
\\
\hline\end{tabulary}


With the exception of volcanic and solar, all forcing outputs are
calculated from the input emissions.


\section{A multi-gas example}
\label{\detokenize{examples:a-multi-gas-example}}
This sets up a multi-gas emissions array and serves to demonstrate some
of the options that can be specified in \sphinxcode{fair\_scm} for multi-gas runs
(most are changed from the default and some are non-sensical but shown
for illustration). Note this is a completely hypothetical scenario!

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{scipy.stats} \PYG{k+kn}{import} \PYG{n}{gamma}
\PYG{n}{emissions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{,}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} remember column zero is the years}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1850}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} add some CO2 fossil and land use, GtC/yr}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{10.}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{1.}

\PYG{c+c1}{\PYGZsh{} some methane and nitrous oxide in this example, Mt/yr}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{300.}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{19.}

\PYG{c+c1}{\PYGZsh{} aerosol and ozone precursors, Mt/yr}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{0.1}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} SOx}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{500.}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} CO}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{100.}\PYG{o}{+}\PYG{l+m+mf}{100.}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} NMVOC}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{40.}\PYG{o}{*}\PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{250}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{9}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} NOx}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{6.}    \PYG{c+c1}{\PYGZsh{} BC}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{30.}  \PYG{c+c1}{\PYGZsh{} OC}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{11}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{35.}  \PYG{c+c1}{\PYGZsh{} NH3}

\PYG{c+c1}{\PYGZsh{} throw in some CFCs}
\PYG{n}{emissions}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{1000.} \PYG{c+c1}{\PYGZsh{} CFC11}
\PYG{c+c1}{\PYGZsh{} and leave all other emissions as zero.}

\PYG{c+c1}{\PYGZsh{} Volcanic and solar forcing are provided externally. Let\PYGZsq{}s invent some}
\PYG{n}{solar} \PYG{o}{=} \PYG{l+m+mf}{0.1} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{11.5}\PYG{p}{)}
\PYG{n}{volcanic} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{gamma}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{250}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} efficacies are the temperature change for each forcing agent compared to CO2}
\PYG{c+c1}{\PYGZsh{} in our runs we usually set the efficacy of BC on snow to 3, following Bond et}
\PYG{c+c1}{\PYGZsh{} al (2013)}
\PYG{n}{eff} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{l+m+mi}{13}\PYG{p}{)}
\PYG{n}{eff}\PYG{p}{[}\PYG{l+m+mi}{9}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{3.0}

\PYG{c+c1}{\PYGZsh{} b\PYGZus{}aero: ERFari for each SLCF species (indices 5 to 11)}
\PYG{c+c1}{\PYGZsh{} b\PYGZus{}tro3: tropospheric ozone coeffs for CH4, CO, NMVOC, NOx}
\PYG{n}{C}\PYG{p}{,}\PYG{n}{F}\PYG{p}{,}\PYG{n}{T} \PYG{o}{=} \PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{emissions}\PYG{p}{,}
                 \PYG{n}{natural}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{250}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} natural emissions of CH4 and N2O}
                 \PYG{n}{aviNOx\PYGZus{}frac}\PYG{o}{=}\PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} proportion of NOx emissions from aviation}
                 \PYG{n}{fossilCH4\PYGZus{}frac}\PYG{o}{=}\PYG{l+m+mf}{0.25}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} proportion of anthro CH4 emis from fossil fuels}
                 \PYG{n}{oxCH4\PYGZus{}frac}\PYG{o}{=}\PYG{l+m+mf}{0.61}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} proportion of fossil CH4 eventually oxidised to CO2}
                 \PYG{n}{stwv\PYGZus{}from\PYGZus{}ch4}\PYG{o}{=}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} proportion of CH4 ERF contributing to strat H2O}
                 \PYG{n}{ghg\PYGZus{}forcing}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Etminan}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} etminan or myhre}
                 \PYG{n}{useStevenson}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} Stevenson or regression based trop. O3 forcing?}
                 \PYG{n}{b\PYGZus{}aero} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{35}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{450}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{40}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}4}\PYG{p}{,}
                 \PYG{n}{b\PYGZus{}tro3} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{3.}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{p}{,} \PYG{l+m+mf}{8.}\PYG{p}{,} \PYG{l+m+mf}{99.}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}4}\PYG{p}{,}
                 \PYG{n}{aerosol\PYGZus{}forcing} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{aerocom+ghan}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} aerocom, aerocom+ghan or stevens}
                 \PYG{n}{F\PYGZus{}solar} \PYG{o}{=} \PYG{n}{solar}\PYG{p}{,}
                 \PYG{n}{F\PYGZus{}volcanic} \PYG{o}{=} \PYG{n}{volcanic}\PYG{p}{,}
                 \PYG{n}{efficacy} \PYG{o}{=} \PYG{n}{eff}
                \PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot the forcing from each component}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{label} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CH4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N2O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Other GHG}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Trop O3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Strat O3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Strat H2O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Contrails}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Aerosols}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{BC on snow}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Land use}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Volcanic}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Solar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{13}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{ax} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1850}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}\PYG{p}{,} \PYG{n}{F}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mf}{0.95}\PYG{p}{,}\PYG{l+m+mf}{0.95}\PYG{p}{,}\PYG{n}{label}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{transform}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{transAxes}\PYG{p}{,}\PYG{n}{va}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{top}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ha}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plot temperature change}
\PYG{n}{ax} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1850}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mf}{0.95}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature change}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{transform}\PYG{o}{=}\PYG{n}{ax}\PYG{o}{.}\PYG{n}{transAxes}\PYG{p}{,} \PYG{n}{va}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bottom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ha}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Text}\PYG{p}{(}\PYG{l+m+mf}{0.95}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s1}{u\PYGZsq{}}\PYG{l+s+s1}{Temperature change}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_23_1}.png}


\section{RCP scenarios}
\label{\detokenize{examples:rcp-scenarios}}
Creating a 40-column emissions input table may seem a lot of work. FAIR
comes with tools to make your life easier!

We can run FAIR with the CO2 emissions and non-CO2 forcing from the four
representative concentration pathway scenarios. These can be imported
from the \sphinxcode{RCPs} module and have inbuilt \sphinxcode{Forcing} and \sphinxcode{Emissions}
classes. There is also a tool for converting MAGICC6 *.SCEN files into
FAIR input (in \sphinxcode{fair/tools/magicc}).

Here we show the FAIR implementation of the RCP scenarios. Following
Meinshausen's convention RCP3PD is an alias for RCP2.6.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get RCP modules}
\PYG{k+kn}{from} \PYG{n+nn}{fair.RCPs} \PYG{k+kn}{import} \PYG{n}{rcp3pd}\PYG{p}{,} \PYG{n}{rcp45}\PYG{p}{,} \PYG{n}{rcp6}\PYG{p}{,} \PYG{n}{rcp85}

\PYG{c+c1}{\PYGZsh{} Basic RCP runs}
\PYG{n}{C26}\PYG{p}{,} \PYG{n}{F26}\PYG{p}{,} \PYG{n}{T26} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{emissions}\PYG{p}{)}
\PYG{n}{C45}\PYG{p}{,} \PYG{n}{F45}\PYG{p}{,} \PYG{n}{T45} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{emissions}\PYG{p}{)}
\PYG{n}{C60}\PYG{p}{,} \PYG{n}{F60}\PYG{p}{,} \PYG{n}{T60} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{emissions}\PYG{p}{)}
\PYG{n}{C85}\PYG{p}{,} \PYG{n}{F85}\PYG{p}{,} \PYG{n}{T85} \PYG{o}{=} \PYG{n}{fair}\PYG{o}{.}\PYG{n}{forward}\PYG{o}{.}\PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{emissions}\PYG{p}{)}

\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{co2\PYGZus{}fossil}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP2.6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} just show CO2 conc.}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} sum over axis 1 to get total ERF}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{F26}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{T26}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{co2\PYGZus{}fossil}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{F45}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{T45}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{co2\PYGZus{}fossil}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{F60}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{T60}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{co2\PYGZus{}fossil}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{F85}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{T85}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fossil CO\PYGZdl{}\PYGZus{}2\PYGZdl{} Emissions (GtC)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO\PYGZdl{}\PYGZus{}2\PYGZdl{} concentrations (ppm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Total radiative forcing (W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature anomaly (K)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_25_0}.png}


\section{Concentrations of well-mixed greenhouse gases}
\label{\detokenize{examples:concentrations-of-well-mixed-greenhouse-gases}}
In this example we also show how to group minor gases into CFC12 and
HFC134a equivalent concentrations. Refer to table above for gas indices.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP3PD}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Methane concentrations, ppb}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP3PD}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Nitrous oxide concentrations, ppb}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Weight H and F gases by radiative efficiency}
\PYG{k+kn}{from} \PYG{n+nn}{fair.constants} \PYG{k+kn}{import} \PYG{n}{radeff}

\PYG{c+c1}{\PYGZsh{} indices 3:15 are HFCs and PFCs}
\PYG{n}{C26\PYGZus{}hfc134a\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{HFC134A}
\PYG{n}{C45\PYGZus{}hfc134a\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{HFC134A}
\PYG{n}{C60\PYGZus{}hfc134a\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{HFC134A}
\PYG{n}{C85\PYGZus{}hfc134a\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{HFC134A}

\PYG{c+c1}{\PYGZsh{} indices 15:31 are ozone depleters}
\PYG{n}{C26\PYGZus{}cfc12\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{CFC12}
\PYG{n}{C45\PYGZus{}cfc12\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{CFC12}
\PYG{n}{C60\PYGZus{}cfc12\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{CFC12}
\PYG{n}{C85\PYGZus{}cfc12\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{C85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{o}{*}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{aslist}\PYG{p}{[}\PYG{l+m+mi}{15}\PYG{p}{:}\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{radeff}\PYG{o}{.}\PYG{n}{CFC12}

\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C26\PYGZus{}hfc134a\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP2.6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C45\PYGZus{}hfc134a\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C60\PYGZus{}hfc134a\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C85\PYGZus{}hfc134a\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HFC134a equivalent concentrations, ppt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C26\PYGZus{}cfc12\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP2.6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C45\PYGZus{}cfc12\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C60\PYGZus{}cfc12\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C85\PYGZus{}cfc12\PYGZus{}eq}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{CFC12 equivalent concentrations, ppt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_27_0}.png}


\section{Radiative forcing}
\label{\detokenize{examples:radiative-forcing}}
Here we show some of the more interesting examples for the effective
radiative forcing time series coming out of FAIR.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}
\PYG{n}{ax3} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{223}\PYG{p}{)}
\PYG{n}{ax4} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP2.6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Tropospheric ozone forcing, W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP2.6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Stratospheric ozone forcing, W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP2.6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax3}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Aerosol forcing, W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp3pd}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F26}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP2.6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp6}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F60}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{F85}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP8.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax4}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Land use forcing, W m\PYGZdl{}\PYGZca{}\PYGZob{}\PYGZhy{}2\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_29_0}.png}


\section{Natural emissions and GHG lifetimes}
\label{\detokenize{examples:natural-emissions-and-ghg-lifetimes}}
In order to balance historical concentrations of methane and nitrous
oxide, we assume a time-varying profile of natural emissions. This can
be varied with the \sphinxcode{natural} keyword (a \sphinxcode{(nt, 2)} array of methane
and nitrous oxide emissions). Additionally, the default greenhouse gas
decay constants can be modified with the \sphinxcode{lifetimes} keyword (shape
\sphinxcode{(31,)}).

It can clearly be seen that natural emissions are important in
maintaining historical concentrations.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Change default lifetimes of CH4 and N2O}
\PYG{k+kn}{from} \PYG{n+nn}{fair.constants} \PYG{k+kn}{import} \PYG{n}{lifetime}
\PYG{n}{lt} \PYG{o}{=} \PYG{n}{lifetime}\PYG{o}{.}\PYG{n}{aslist}
\PYG{n}{lt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{12.6}
\PYG{n}{lt}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{131.}

\PYG{c+c1}{\PYGZsh{} what are the defaults?}
\PYG{k}{print} \PYG{p}{(}\PYG{n}{lifetime}\PYG{o}{.}\PYG{n}{CH4}\PYG{p}{,} \PYG{n}{lifetime}\PYG{o}{.}\PYG{n}{N2O}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} How long are the RCPs?}
\PYG{n}{nt} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Run FAIR under RCP4.5 with no natural emissions}
\PYG{n}{C1}\PYG{p}{,}\PYG{n}{F1}\PYG{p}{,}\PYG{n}{T1} \PYG{o}{=} \PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{emissions}\PYG{p}{,}
                    \PYG{n}{natural}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
                    \PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Run FAIR under RCP4.5 with modified lifetimes}
\PYG{n}{C2}\PYG{p}{,}\PYG{n}{F2}\PYG{p}{,}\PYG{n}{T2} \PYG{o}{=} \PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{emissions}\PYG{p}{,}
                    \PYG{n}{lifetimes}\PYG{o}{=}\PYG{n}{lt}
                    \PYG{p}{)}

\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{221}\PYG{p}{)}
\PYG{n}{ax2} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{222}\PYG{p}{)}

\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5 default}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C1}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ls}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5 no natural}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C2}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ls}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5 modified lifetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Methane concentrations, ppb}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C45}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C1}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ls}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5 no natural}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp45}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{C2}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ls}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RCP4.5 modified lifetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Nitrous oxide concentrations, ppb}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{(}\PYG{l+m+mf}{9.3}\PYG{p}{,} \PYG{l+m+mf}{121.0}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_31_1}.png}


\section{Ensemble generation}
\label{\detokenize{examples:ensemble-generation}}
An advantage of FAIR is that it is very quick to run (much less than a
second on an average machine). Therefore it can be used to generate
probabilistic future ensembles. We'll show a 100-member ensemble.

This example also introduces the \sphinxcode{scale} and \sphinxcode{F2x} keywords.
\sphinxcode{scale} (a 13 element array) governs the forcing scaling factor of
each of the 13 categories of forcing, whereas \sphinxcode{F2x} determines the ERF
from a doubling of CO2.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{scipy} \PYG{k+kn}{import} \PYG{n}{stats}

\PYG{c+c1}{\PYGZsh{} generate some (bad) TCR and ECS pairs}
\PYG{n}{tcrecs} \PYG{o}{=} \PYG{n}{stats}\PYG{o}{.}\PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mf}{1.75}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mf}{0.4}\PYG{p}{,}\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{38571}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} generate some forcing scale factors with SD of 10\PYGZpc{} of the best estimate}
\PYG{n}{F\PYGZus{}scale} \PYG{o}{=} \PYG{n}{stats}\PYG{o}{.}\PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{13}\PYG{p}{)}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{40000}\PYG{p}{)}
\PYG{n}{F2x} \PYG{o}{=} \PYG{l+m+mf}{3.71} \PYG{o}{*} \PYG{n}{F\PYGZus{}scale}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{F\PYGZus{}scale}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{1.0}  \PYG{c+c1}{\PYGZsh{} set CO2 forcing scaling with F2x above}

\PYG{c+c1}{\PYGZsh{} generate ensemble for carbon cycle parameters}
\PYG{n}{r0} \PYG{o}{=} \PYG{n}{stats}\PYG{o}{.}\PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{35}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{3.5}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{41000}\PYG{p}{)}
\PYG{n}{rc} \PYG{o}{=} \PYG{n}{stats}\PYG{o}{.}\PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mf}{0.019}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{0.0019}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42000}\PYG{p}{)}
\PYG{n}{rt} \PYG{o}{=} \PYG{n}{stats}\PYG{o}{.}\PYG{n}{norm}\PYG{o}{.}\PYG{n}{rvs}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mf}{4.165}\PYG{p}{,} \PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mf}{0.4165}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{45000}\PYG{p}{)}

\PYG{n}{T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} notice that we}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{\PYGZus{}}\PYG{p}{,} \PYG{n}{\PYGZus{}}\PYG{p}{,} \PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{fair\PYGZus{}scm}\PYG{p}{(}\PYG{n}{emissions}\PYG{o}{=}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{emissions}\PYG{p}{,}
                            \PYG{n}{r0} \PYG{o}{=} \PYG{n}{r0}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}
                            \PYG{n}{rc} \PYG{o}{=} \PYG{n}{rc}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}
                            \PYG{n}{rt} \PYG{o}{=} \PYG{n}{rt}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}
                            \PYG{n}{tcrecs} \PYG{o}{=} \PYG{n}{tcrecs}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,}
                            \PYG{n}{scale} \PYG{o}{=} \PYG{n}{F\PYGZus{}scale}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,}
                            \PYG{n}{F2x} \PYG{o}{=} \PYG{n}{F2x}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
                           \PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{111}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_34_0}.png}


\subsection{Adding a temperature constraint}
\label{\detokenize{examples:adding-a-temperature-constraint}}
The resulting projections show a large spread. Some of these ensemble
members are unrealistic, ranging from around 0.4 to 2.0 K temperature
change in the present day, whereas we know in reality it is more like
0.95 (plus or minus 0.2). Therefore we can constrain this ensemble to
observations.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{fair.tools.constrain} \PYG{k+kn}{import} \PYG{n}{hist\PYGZus{}temp}

\PYG{c+c1}{\PYGZsh{} Cowtan \PYGZam{} Way in\PYGZhy{}filled dataset of global temperatures}
\PYG{n}{CW} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../fair/tools/tempobs/had4\PYGZus{}krig\PYGZus{}annual\PYGZus{}v2\PYGZus{}0\PYGZus{}0.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{constrained} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{dtype}\PYG{o}{=}\PYG{n+nb}{bool}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} we use observed trend from 1880 to 2016}
    \PYG{n}{constrained}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{\PYGZus{}}\PYG{p}{,}\PYG{n}{\PYGZus{}}\PYG{p}{,}\PYG{n}{\PYGZus{}}\PYG{p}{,}\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{hist\PYGZus{}temp}\PYG{p}{(}
        \PYG{n}{CW}\PYG{p}{[}\PYG{l+m+mi}{30}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{T}\PYG{p}{[}\PYG{l+m+mi}{1880}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1765}\PYG{p}{:}\PYG{l+m+mi}{2017}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1765}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{CW}\PYG{p}{[}\PYG{l+m+mi}{30}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} How many ensemble members passed the constraint?}
\PYG{k}{print} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{constrained}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{28}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} What does this do to the ensemble?}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax1} \PYG{o}{=} \PYG{n}{fig}\PYG{o}{.}\PYG{n}{add\PYGZus{}subplot}\PYG{p}{(}\PYG{l+m+mi}{111}\PYG{p}{)}
\PYG{n}{ax1}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{rcp85}\PYG{o}{.}\PYG{n}{Emissions}\PYG{o}{.}\PYG{n}{year}\PYG{p}{,} \PYG{n}{T}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{constrained}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{examples_38_0}.png}

Some, but not all, of the higher end scenarios have been constrained
out, but there is still quite a large range of total temperature change
projected for 2500 even under this constraint.

From these constraints it is possible to obtain posterior distributions
on effective radiative forcing, ECS, TCR, TCRE and other metrics.


\chapter{References}
\label{\detokenize{references:references}}\label{\detokenize{references::doc}}
Armour, K.: Energy budget constraints on climate sensitivity in light of inconstant climate feedbacks, Nat. Clim. Change, 7, 331\textendash{}335, \sphinxurl{https://doi.org/10.1038/nclimate3278}, 2017

Gregory, J. M. and Andrews, T.: Variation in climate sensitivity and feedback parameters during the historical period, Geophys. Res. Lett.,
43, 3911\textendash{}3920, \sphinxurl{https://doi.org/10.1002/2016GL068406}, 2016GL068406, 2016

Millar, R. J., Nicholls, Z. R., Friedlingstein, P., and Allen, M. R.: A modified impulse-response representation of the global near-surface air temperature and atmospheric concentration response to carbon dioxide emissions, Atmos. Chem. Phys., 2017, 7213\textendash{}7228,
\sphinxurl{https://doi.org/10.5194/acp-17-7213-2017}, 2017

Myhre, G., Shindell, D., Bron, F.-M., Collins, W., Fuglestvedt, J., Huang, J., Koch, D., Lamarque, J.-F., Lee, D., Mendoza, B., Nakajima, T., Robock, A., Stephens, G., Takemura, T., and Zhang, H.: Anthropogenic and Natural Radiative Forcing, in: Climate Change 2013: The Physical Science Basis. Contribution of Working Group I to the Fifth Assessment Report of the Intergovernmental Panel on Climate Change, edited by Stocker, T., Qin, D., Plattner, G.-K., Tignor, M., Allen, S., Boschung, J., Nauels, A., Xia, Y., Bex, V., and Midgley, P., pp. 659\textendash{}740, Cambridge University Press, Cambridge, United Kingdom and New York, NY, USA, 2013

Smith, C. J., Forster, P. M., Allen, M., Leach, N., Millar, R. J., Passerello, G. A., and Regayre, L. A.: FAIR v1.3: A simple emissions-based impulse response and carbon cycle model, Geosci. Model Dev. \sphinxurl{https://doi.org/10.5194/gmd-2017-266}, 2018.



\renewcommand{\indexname}{Index}
\printindex
\end{document}